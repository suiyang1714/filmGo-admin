{"version":3,"sources":["webpack:///webpack/bootstrap 53e2fba7d65836ec29ec","webpack:///external \"mongoose\"","webpack:///./~/babel-runtime/regenerator/index.js","webpack:///./server/database/schema/flim.js","webpack:///./server/database/schema/genre.js","webpack:///./server/database/schema/admin.js","webpack:///./server/database/schema/category.js","webpack:///./server/database/schema/comment.js","webpack:///./server/database/schema/user.js","webpack:///external \"fs\"","webpack:///external \"path\"","webpack:///./nuxt.config.js","webpack:///./server/database/database.js","webpack:///./server/router/index.js","webpack:///external \"koa\"","webpack:///external \"koa-bodyparser\"","webpack:///external \"koa-session\"","webpack:///external \"koa2-cors\"","webpack:///external \"nuxt\"","webpack:///./server/config/index.js","webpack:///./server/database/schema ^\\.\\/.*$","webpack:///external \"bcryptjs\"","webpack:///external \"koa-router\"","webpack:///external \"regenerator-runtime\"","webpack:///./server/index.js"],"names":["mongoose","require","Schema","FilmSchema","title","String","pv","type","Number","default","comment","rating","Object","abstract","year","images","id","countries","Array","genres","name","source","ref","aka","casts","original_title","summary","directors","releaseDate","runtime","postPic","trailerPoster","trailerUri","trailerArray","meta","createdAt","updatedAt","Film","model","module","exports","GenreSchema","filmArray","Date","now","pre","next","isNew","Genre","bcrypt","SALT_WORK_FACTOR","MAX_LOGIN_ATTEMPTS","LOCK_TIME","AdminSchema","user","password","nickname","role","isModified","genSalt","err","salt","hash","error","methods","comparePassword","_password","Promise","resolve","reject","compare","isMatch","incLoginAttempts","that","lockUntil","update","$set","loginAttempts","$unset","updates","$inc","isLocked","Admin","CategorySchema","articleArray","Category","CommentSchema","articleId","from","reply","to","content","updateTime","Comment","UserSchema","openid","avatarUrl","unionid","province","country","city","gender","MinaUser","head","charset","hid","link","rel","href","css","loading","color","build","extend","config","ctx","isClient","rules","push","enforce","test","loader","exclude","fs","models","__dirname","readdirSync","filter","file","search","forEach","database","set","global","connect","db","connection","on","console","log","findOne","save","router","get","find","exec","films","body","success","data","query","film","app","host","process","env","HOST","port","PORT","dev","nuxt","builder","use","cors","origin","exposeHeaders","maxAge","credentials","allowMethods","allowHeaders","bodyParser","mongodb","keys","CONFIG","key","overwrite","httpOnly","signed","rolling","session","filmApi","routes","allowedMethods","status","req","res","render","promise","then","catch","listen","start"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 29);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 53e2fba7d65836ec29ec","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/regenerator/index.js\n// module id = 1\n// module chunks = 0","const mongoose = require('mongoose')\nconst { Schema } = mongoose\n\nconst FilmSchema = new Schema({\n  title: String,\n  pv: {\n    type: Number,\n    default: 1\n  },\n  comment: {\n    type: Number,\n    default: 0\n  },\n  rating: Object,\n  abstract: String,\n  year: String,\n  images: Object,\n  id: String,\n  countries: Array,\n  genres: [\n    {\n      name: String,\n      source: {\n        type: String,\n        ref: 'Tag'\n      }\n    }\n  ],\n  aka: Array,\n  casts: Array,\n  original_title: String,\n  summary: String,\n  directors: Array,\n  releaseDate: Array,\n  runtime: String,\n  postPic: String,\n  trailerPoster: String,\n  trailerUri: Array,\n  trailerArray: Array,\n  meta: {\n    createdAt: {\n      type: String\n    },\n    updatedAt: {\n      type: String\n    }\n  }\n})\n\nconst Film = mongoose.model('Film', FilmSchema)\n\nmodule.exports = Film\n\n\n\n// WEBPACK FOOTER //\n// ./server/database/schema/flim.js","const mongoose = require('mongoose')\nconst { Schema } = mongoose\n\nconst GenreSchema = new Schema({\n  name: String,\n  filmArray: [\n    {\n      type: String,\n      ref: 'Article'\n    }\n  ],\n  meta: {\n    createdAt: {\n      type: Date,\n      default: Date.now()\n    },\n    updatedAt: {\n      type: Date,\n      default: Date.now()\n    }\n  }\n})\nGenreSchema.pre('save', function (next) {\n  if (this.isNew) {\n    this.meta.createdAt = this.meta.updatedAt = Date.now()\n  } else {\n    this.meta.updatedAt = Date.now()\n  }\n\n  next()\n})\n\nconst Genre = mongoose.model('Genre', GenreSchema)\n\nmodule.exports = Genre\n\n\n\n// WEBPACK FOOTER //\n// ./server/database/schema/genre.js","const mongoose = require('mongoose')\nconst bcrypt = require('bcryptjs')\n\nconst SALT_WORK_FACTOR = 10\nconst MAX_LOGIN_ATTEMPTS = 5\nconst LOCK_TIME = 2 * 60 * 60 * 1000\nconst Schema = mongoose.Schema\n\nconst AdminSchema = new Schema({\n  user: String,\n  password: String,\n  nickname: String,\n  role: {\n    type: String,\n    default: 'user'\n  },\n  meta: {\n    createdAt: {\n      type: Date,\n      default: Date.now()\n    },\n    updatedAt: {\n      type: Date,\n      default: Date.now()\n    }\n  }\n})\n\nAdminSchema.pre('save', function(next) {\n  if (this.isNew) {\n    this.meta.createdAt = this.meta.updatedAt = Date.now()\n  } else {\n    this.meta.updatedAt = Date.now()\n  }\n\n  next()\n})\n\nAdminSchema.pre('save', function(next) {\n  var user = this\n\n  if (!user.isModified('password')) return next()\n\n  bcrypt.genSalt(SALT_WORK_FACTOR, (err, salt) => {\n    if (err) return next(err)\n    bcrypt.hash(user.password, salt, (error, hash) => {\n      if (error) return next(error)\n\n      user.password = hash\n      next()\n    })\n  })\n})\n\nAdminSchema.methods = {\n  comparePassword: function (_password, password) {\n    return new Promise((resolve, reject) => {\n      bcrypt.compare(_password, password, function(err, isMatch) {\n        if (!err) resolve(isMatch)\n        else reject(err)\n      })\n    })\n  },\n\n  incLoginAttempts: function (user) {\n    var that = this\n\n    return new Promise((resolve, reject) => {\n      if (that.lockUntil && that.lockUntil < Date.now()) {\n        that.update({\n          $set: {\n            loginAttempts: 1\n          },\n          $unset: {\n            lockUntil: 1\n          }\n        }, function(err) {\n          if (!err) resolve(true)\n          else reject(err)\n        })\n      }\n      var updates = {\n        $inc: {\n          loginAttempts: 1\n        }\n      }\n      if (that.loginAttempts + 1 >= MAX_LOGIN_ATTEMPTS && !that.isLocked) {\n        updates.$set = {\n          lockUntil: Date.now() + LOCK_TIME\n        }\n      }\n\n      that.update(updates, err => {\n        if (!err) resolve(true)\n        else reject(err)\n      })\n    })\n  }\n}\n\nconst Admin = mongoose.model('Admin', AdminSchema)\n\nmodule.exports = Admin\n\n\n\n// WEBPACK FOOTER //\n// ./server/database/schema/admin.js","const mongoose = require('mongoose')\nconst { Schema } = mongoose\n\nconst CategorySchema = new Schema({\n  name: String,\n  articleArray: [\n    {\n      type: String,\n      ref: 'Article'\n    }\n  ],\n  meta: {\n    createdAt: {\n      type: Date,\n      default: Date.now()\n    },\n    updatedAt: {\n      type: Date,\n      default: Date.now()\n    }\n  }\n})\nCategorySchema.pre('save', function (next) {\n  if (this.isNew) {\n    this.meta.createdAt = this.meta.updatedAt = Date.now()\n  } else {\n    this.meta.updatedAt = Date.now()\n  }\n\n  next()\n})\n\nconst Category = mongoose.model('Category', CategorySchema)\n\nmodule.exports = Category\n\n\n\n// WEBPACK FOOTER //\n// ./server/database/schema/category.js","const mongoose = require('mongoose')\nconst { Schema } = mongoose\n\nconst CommentSchema = new Schema({\n  articleId: {\n    type: String,\n    ref: 'Article'\n  },\n  from: {\n    type: String,\n    ref: 'User'\n  },\n  reply: [{\n    from: {\n      type: String,\n      ref: 'User'\n    },\n    to: {\n      type: String,\n      ref: 'User'\n    },\n    content: String,\n    updateTime: String\n  }],\n  content: String,\n  meta: {\n    createdAt: {\n      type: Date,\n      default: Date.now()\n    },\n    updatedAt: {\n      type: Date,\n      default: Date.now()\n    }\n  }\n})\nCommentSchema.pre('save', function (next) {\n  if (this.isNew) {\n    this.meta.createdAt = this.meta.updatedAt = Date.now()\n  } else {\n    this.meta.updatedAt = Date.now()\n  }\n\n  next()\n})\n\nconst Comment = mongoose.model('Comment', CommentSchema)\n\nmodule.exports = Comment\n\n\n\n// WEBPACK FOOTER //\n// ./server/database/schema/comment.js","const mongoose = require('mongoose')\nconst Schema = mongoose.Schema\n\nconst UserSchema = new Schema({\n  openid: String,\n  avatarUrl: String,\n  nickname: String,\n  role: {\n    type: String,\n    default: 'user'\n  },\n  unionid: String,\n  province: String,\n  country: String,\n  city: String,\n  gender: String,\n  password: {\n    type: String\n  },\n  meta: {\n    createdAt: {\n      type: Date,\n      default: Date.now()\n    },\n    updatedAt: {\n      type: Date,\n      default: Date.now()\n    }\n  }\n})\n\nUserSchema.pre('save', function (next) {\n  if (this.isNew) {\n    this.meta.createdAt = this.meta.updatedAt = Date.now()\n  } else {\n    this.meta.updatedAt = Date.now()\n  }\n\n  next()\n})\n\nconst MinaUser = mongoose.model('MinaUser', UserSchema)\n\nmodule.exports = MinaUser\n\n\n\n// WEBPACK FOOTER //\n// ./server/database/schema/user.js","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 9\n// module chunks = 0","module.exports = {\n  /*\n  ** Headers of the page\n  */\n  head: {\n    title: 'starter',\n    meta: [\n      { charset: 'utf-8' },\n      { name: 'viewport', content: 'width=device-width, initial-scale=1' },\n      { hid: 'description', name: 'description', content: 'Nuxt.js project' }\n    ],\n    link: [\n      { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' }\n    ]\n  },\n  /*\n  ** Global CSS\n  */\n  css: ['~assets/css/main.css'],\n  /*\n  ** Customize the progress-bar color\n  */\n  loading: { color: '#3B8070' },\n  /*\n   ** Build configuration\n   */\n  build: {\n    /*\n     ** Run ESLINT on save\n     */\n    extend (config, ctx) {\n      if (ctx.isClient) {\n        config.module.rules.push({\n          enforce: 'pre',\n          test: /\\.(js|vue)$/,\n          loader: 'eslint-loader',\n          exclude: /(node_modules)/\n        })\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js","var fs = require('fs')\nvar resolve = require('path').resolve\nvar mongoose = require('mongoose')\nvar config = require('../config')\n\n/*const models = resolve(__dirname, './schema')\nfs.readdirSync(models)\n  .filter(file => ~file.search(/^[^\\.].*js$/))\n  .forEach(file => require(resolve(models, file)))*/\nconst models = resolve(__dirname, '../database/schema')\nfs.readdirSync(models)\n  .filter(file => ~file.search(/^[^\\.].*js$/))\n  .forEach(file => {\n    require(`../database/schema/${file}`)\n    // require(resolve(models,file))\n  })\n\nconst database = () => {\n\n    mongoose.set('debug', true)\n\n    mongoose.Promise = global.Promise\n\n    mongoose.connect(config.db)\n\n    mongoose.connection.on('disconnected', () => {\n        mongoose.connect(config.db)\n    })\n    mongoose.connection.on('error', err => {\n        console.error(err)\n    })\n\n    mongoose.connection.on('open', async () => {\n\n      console.log('Connected to MongoDB ', config.db)\n\n      const Admin = mongoose.model('Admin')\n      let user = await Admin.findOne({\n        user: 'admin'\n      })\n\n      if (!user) {\n        console.log('写入管理员数据')\n\n        user = new Admin({\n          user: 'admin',\n          password: '123456',\n          role: 'superAdmin',\n          nickname: 'Aditya Sui'\n        })\n\n        await user.save()\n      }\n\n    })\n\n}\n\nmodule.exports = database\n\n\n\n// WEBPACK FOOTER //\n// ./server/database/database.js","const router = require('koa-router')()\n\nconst Film = require('../database/schema/flim')\nconst Genre = require('../database/schema/genre')\n\nrouter.get('/api/film/comingsoon', async (ctx, next) => {\n  let films = await Film\n    .find()\n    .exec()\n  ctx.body = {\n    success: true,\n    data: films\n  }\n})\nrouter.get('/api/film/id', async (ctx, next) => {\n  const id = ctx.query.id\n  const film = await Film\n    .findOne({id: id})\n    .exec()\n  ctx.body = {\n    success: true,\n    data: film\n\n  }\n})\n\nmodule.exports = router\n\n\n\n// WEBPACK FOOTER //\n// ./server/router/index.js","module.exports = require(\"koa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"koa-bodyparser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-bodyparser\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"koa-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-session\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"koa2-cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa2-cors\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 17\n// module chunks = 0","const config = {\n  db:'mongodb://127.0.0.1/filmgo'\n}\n\nmodule.exports = config\n\n\n\n// WEBPACK FOOTER //\n// ./server/config/index.js","var map = {\n\t\"./admin\": 4,\n\t\"./admin.js\": 4,\n\t\"./category\": 5,\n\t\"./category.js\": 5,\n\t\"./comment\": 6,\n\t\"./comment.js\": 6,\n\t\"./flim\": 2,\n\t\"./flim.js\": 2,\n\t\"./genre\": 3,\n\t\"./genre.js\": 3,\n\t\"./user\": 7,\n\t\"./user.js\": 7\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 22;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./server/database/schema ^\\.\\/.*$\n// module id = 22\n// module chunks = 0","module.exports = require(\"bcryptjs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bcryptjs\"\n// module id = 24\n// module chunks = 0","module.exports = require(\"koa-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-router\"\n// module id = 26\n// module chunks = 0","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 27\n// module chunks = 0","import Koa from 'koa'\nimport { Nuxt, Builder } from 'nuxt'\n// after end\n\nimport session from 'koa-session'\n\nimport cors from 'koa2-cors'\n\nconst filmApi = require('./router')\nconst mongodb = require('./database/database')\nconst bodyParser = require('koa-bodyparser')\n\nasync function start () {\n  const app = new Koa()\n  const host = process.env.HOST || '127.0.0.1'\n  const port = process.env.PORT || 5000\n\n  // Import and Set Nuxt.js options\n  let config = require('../nuxt.config.js')\n  config.dev = !(app.env === 'production')\n\n  // Instantiate nuxt.js\n  const nuxt = new Nuxt(config)\n\n  // Build in development\n  if (config.dev) {\n    const builder = new Builder(nuxt)\n    await builder.build()\n  }\n  app.use(cors({\n    origin: function (ctx) {\n      return 'http://localhost:7998'\n    },\n    exposeHeaders: ['WWW-Authenticate', 'Server-Authorization'],\n    maxAge: 5,\n    credentials: true,\n    allowMethods: ['GET', 'POST', 'DELETE'],\n    allowHeaders: ['Content-Type', 'Authorization', 'Accept']\n  }))\n  // body-parser\n  app.use(bodyParser())\n\n  // mongodb\n  mongodb()\n\n  // session\n  app.keys = ['some session']\n\n  const CONFIG = {\n    key: 'SESSION', /** (string) cookie key (default is koa:sess) */\n    /** (number || 'session') maxAge in ms (default is 1 days) */\n    /** 'session' will result in a cookie that expires when session/browser is closed */\n    /** Warning: If a session cookie is stolen, this cookie will never expire */\n    maxAge: 86400000,\n    overwrite: true, /** (boolean) can overwrite or not (default true) */\n    httpOnly: true, /** (boolean) httpOnly or not (default true) */\n    signed: true, /** (boolean) signed or not (default true) */\n    rolling: false /** (boolean) Force a session identifier cookie to be set on every response. The expiration is reset to the original maxAge, resetting the expiration countdown. default is false **/\n  }\n  app.use(session(CONFIG, app))\n\n  // routes\n  app.use(filmApi.routes(), filmApi.allowedMethods())\n\n  app.use(async (ctx, next) => {\n    await next()\n    ctx.status = 200 // koa defaults to 404 when it sees that status is unset\n    ctx.req.session = ctx.session\n    return new Promise((resolve, reject) => {\n      ctx.res.on('close', resolve)\n      ctx.res.on('finish', resolve)\n      nuxt.render(ctx.req, ctx.res, promise => {\n        // nuxt.render passes a rejected promise into callback on error.\n        promise.then(resolve).catch(reject)\n      })\n    })\n  })\n\n  app.listen(port, host)\n  console.log('Server listening on ' + host + ':' + port) // eslint-disable-line no-console\n}\n\nstart()\n\n\n\n// WEBPACK FOOTER //\n// ./server/index.js"],"sourceRoot":""}